<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="笔记">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="笔记">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="笔记">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>笔记</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">烂笔头</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tag"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/11/20180110-less/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/20180110-less/" itemprop="url">Less</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T22:26:44+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>作者：dkvirus</p>
<p>链接：<a href="https://www.jianshu.com/p/48018e5da7dd" target="_blank" rel="noopener">https://www.jianshu.com/p/48018e5da7dd</a></p>
<p>來源：简书</p>
<h2 id="什么是less"><a href="#什么是less" class="headerlink" title="什么是less"></a>什么是less</h2><p>Less 是一门 CSS 预处理语言，它扩展了 CSS 语言，增加了变量、Mixin、函数等特性，使 CSS 更易维护和扩展。</p>
<p>Less 可以运行在 Node 或浏览器端。</p>
<h2 id="怎么使用"><a href="#怎么使用" class="headerlink" title="怎么使用"></a>怎么使用</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g less</span><br></pre></td></tr></table></figure>
<h3 id="命令行用法"><a href="#命令行用法" class="headerlink" title="命令行用法"></a>命令行用法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lessc styles.less styles.css</span><br></pre></td></tr></table></figure>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>用 @ 符号定义变量，使用 @ 符号获取变量，仅仅将 @变量名 看成是一个字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@classname: main;</span><br><span class="line">@color: red;</span><br><span class="line"></span><br><span class="line">.@classname&#123;</span><br><span class="line">    background-color: @color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="混合"><a href="#混合" class="headerlink" title="混合"></a>混合</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#menu a &#123;</span><br><span class="line">    color: #111;</span><br><span class="line">    border-top: dotted 1px black;</span><br><span class="line">    border-bottom: solid 2px black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu span &#123;</span><br><span class="line">    height: 16px;</span><br><span class="line">    border-top: dotted 1px black;</span><br><span class="line">    border-bottom: solid 2px black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu p &#123;</span><br><span class="line">    color: red;</span><br><span class="line">    border-top: dotted 1px black;</span><br><span class="line">    border-bottom: solid 2px black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到上面三个样式中都有 border-top 和 border-bottom 两个属性，并且内容完全相同；在传统 CSS 写法中只能这样一遍有一遍的去书写重复的内容，在 Less 中通过将公共属性抽取出来作为一个公共类的方式规避这一点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// example2.less</span><br><span class="line">.bordered &#123;</span><br><span class="line">    border-top: dotted 1px black;</span><br><span class="line">    border-bottom: solid 2px black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu a &#123;</span><br><span class="line">    color: #111;</span><br><span class="line">    .bordered;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu span &#123;</span><br><span class="line">    height: 16px;</span><br><span class="line">    .bordered;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu p &#123;</span><br><span class="line">    color: red;</span><br><span class="line">    .bordered();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>混合的类名在定义的时候加上小括弧 ()，那么在转译成 css 文件时就不会出现；</p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// func.less</span><br><span class="line">.border-radius(@radius) &#123;</span><br><span class="line">  -webkit-border-radius: @radius;</span><br><span class="line">     -moz-border-radius: @radius;</span><br><span class="line">          border-radius: @radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#header &#123;</span><br><span class="line">  .border-radius(4px);</span><br><span class="line">&#125;</span><br><span class="line">.button &#123;</span><br><span class="line">  .border-radius(6px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">关于 less 中函数的写法还有以下几种：</span><br><span class="line">// 函数的参数设置默认值：</span><br><span class="line">.border-radius(@radius: 5px) &#123;</span><br><span class="line">  -webkit-border-radius: @radius;</span><br><span class="line">  -moz-border-radius: @radius;</span><br><span class="line">  border-radius: @radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 函数有多个参数时用分号隔开</span><br><span class="line">.mixin(@color; @padding:2) &#123;</span><br><span class="line">  color-2: @color;</span><br><span class="line">  padding-2: @padding;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 函数如果没有参数，在转译成 css 时就不会被打印出来，详见上面混合中的示例</span><br><span class="line">.wrap() &#123;</span><br><span class="line">  text-wrap: wrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 函数参数如果有默认，调用时就是通过变量名称，而不是位置</span><br><span class="line">.mixin(@color: black; @margin: 10px; @padding: 20px) &#123;</span><br><span class="line">  color: @color;</span><br><span class="line">  margin: @margin;</span><br><span class="line">  padding: @padding;</span><br><span class="line">&#125;</span><br><span class="line">.class1 &#123;</span><br><span class="line">  .mixin(@margin: 20px; @color: #33acfe);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 函数参数有个内置变量 @arguments，相当于 js 中的 arguments</span><br><span class="line">.box-shadow(@x: 0; @y: 0; @blur: 1px; @color: #000) &#123;</span><br><span class="line">  -webkit-box-shadow: @arguments;</span><br><span class="line">     -moz-box-shadow: @arguments;</span><br><span class="line">          box-shadow: @arguments;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 函数名允许相同，但参数不同，类似于 java 中多态的概念</span><br><span class="line">.mixin(@color: black) &#123;      </span><br><span class="line">.mixin(@color: black; @margin: 10px) &#123;</span><br></pre></td></tr></table></figure>
<h3 id="父子元素"><a href="#父子元素" class="headerlink" title="父子元素"></a>父子元素</h3><p>在 css 中父子元素的写法通常如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.container &#123;</span><br><span class="line">    padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">.container .article &#123;</span><br><span class="line">    background-color: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 Less 写法如下，父子嵌套关系一目了然。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.container &#123;</span><br><span class="line">    padding: 0;</span><br><span class="line">    .article &#123;</span><br><span class="line">        background-color: red;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，父子元素还要一种是伪类的写法，在 css 中写法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#header :after &#123;</span><br><span class="line">  content: &quot; &quot;;</span><br><span class="line">  display: block;</span><br><span class="line">  font-size: 0;</span><br><span class="line">  height: 0;</span><br><span class="line">  clear: both;</span><br><span class="line">  visibility: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 less 中写法如下，可以看到引入了新的符号 &amp;，以 &amp; 来代替主类 #header。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#header &#123;</span><br><span class="line">  &amp;:after &#123;</span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    display: block;</span><br><span class="line">    font-size: 0;</span><br><span class="line">    height: 0;</span><br><span class="line">    clear: both;</span><br><span class="line">    visibility: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><p>@import 的作用可以看成是将 one.less 的内容复制一份到当前 .less 文件中。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/10/20181210-session/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/10/20181210-session/" itemprop="url">2018121-session</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-10T21:17:16+08:00">
                2018-12-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当客户端通过http协议向服务器发出请求时，服务器如何通过请求中携带的信心唯一标识出客户端</p>
<h3 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h3><p>当服务器返回给客户端一个http响应信息时，其中如果包含Set-Cookie这个头部时，意思就是指示客户端建立一个cookie，并且在后续的http请求中自动发送这个cookie到服务器端，直到这个cookie过期。如果cookie的生存时间是整个会话期间的话，那么浏览器会将cookie保存在内存中，浏览器关闭时就会自动清除这个cookie。另外一种情况就是保存在客户端的硬盘中，浏览器关闭的话，该cookie也不会被清除，下次打开浏览器访问对应网站时，这个cookie就会自动再次发送到服务器端。</p>
<ul>
<li>客户端发送一个http请求到服务器端</li>
<li>服务器端发送一个http响应到客户端，其中包含Set-Cookie头部</li>
<li>客户端发送一个http请求到服务器端，其中包含Cookie头部</li>
<li>服务器端发送一个http响应到客户端</li>
</ul>
<p>cookie可能会被禁用！</p>
<h3 id="GET-and-POST-Data"><a href="#GET-and-POST-Data" class="headerlink" title="GET and POST Data"></a>GET and POST Data</h3><p>客户端还可以将发送给服务器的数据包含在请求的url中，比如请求的参数或者请求的路径中。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /index.php?foo=bar HTTP/1.1</span><br><span class="line">Host: example.org</span><br></pre></td></tr></table></figure>
<p>在服务器执行index.php脚本时，可以通过$_GET[‘foo’]来获取对应的url中foo参数的值，也就是’bar’。</p>
<p>另外一种客户端传递数据到服务器端的方式是将数据包含在http请求的内容区域内。 这种方式需要请求的类型是POST的，看下面一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST /index.php HTTP/1.1</span><br><span class="line">Host: example.org</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 7</span><br><span class="line">foo=bar</span><br></pre></td></tr></table></figure>
<p>将session id 附加在url中以及表单的隐藏字段中，容易泄露session id, 比如有的用户会bookmark一个url或者分享一个url，那么session id也就暴露了，加入这个session id还没有过期，那是有一定的安全问题存在的，除非服务器端，除了session id外，还附加了其它方式进行验证用户的合法性！</p>
<p>尽管以POST的方式来传递session id的话，相对GET的方式来说，会安全的多。但是，这种方式的缺点就是比较麻烦</p>
<p>一个标准的HTTP请求中除了Host等必须包含的头部，还包含了一些可选的头部.举一个例子，看下面的一个请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: example.org</span><br><span class="line">Cookie: PHPSESSID=12345</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en-US; rv:1.8.1.1) Gecko/20061204 Firefox/2.0.0.1</span><br><span class="line">Accept: text/html;q=0.9, */*;q=0.1</span><br><span class="line">Accept-Charset: ISO-8859-1, utf-8;q=0.66, *;q=0.66</span><br><span class="line">Accept-Language: en</span><br></pre></td></tr></table></figure>
<p>因为有相同的session id包含在请求的Cookie头部中，所以相同的php session将会被访问到。但是，请求里的User-Agent头部跟先前的请求中的信息是不同的，系统是否可以假定这两个请求是同一个用户发出的？</p>
<p>像这种情况下，发现浏览器的头部改变了，但是不能肯定这是否是一次来自攻击者的请求的话，比较好的措施就是弹出一个要求输入密码的输入框让用户输入，这样的话，对用户体验的影响不会很大，又能很有效地防止攻击。</p>
<p>你应该也能想到了，既然我们可以检查User-Agent这个头部来加强安全性，那么不妨再利用其它的一些头部信息，把他们组合起来生成一个加密的token，并且让客户端在后续的请求中携带这个token！这样的话，攻击者基本上不可能猜测出这样一个token是怎么生成出来的。这好比你用信用卡在超市付款，一个你必须有信用卡(好比session id)，另外你也必须输入一个支付密码(好比token),这有这两者都符合的情况下，你才能成功进入账号付款。 看下面一段代码：</p>
<p>&lt;?php</p>
<p>session_start();</p>
<p>$token = ‘SHIFLETT’ . $_SERVER[‘HTTP_USER_AGENT’];</p>
<p>$_SESSION[‘token’] = md5($token . session_id());</p>
<p>?&gt;</p>
<p>注意：Accept这个头部不应该被用来生成token,因为有些浏览器会自动改变这个头部，当用户刷新浏览器的时候。</p>
<p>在你的验证机制中加入了这个非常难于猜测出来的token以后，安全性会得到很大的提升。假如这个token通过像session id一样的方式来进行传递，这种情况下，一个攻击者必须完成必要的3步来劫持用户的session:</p>
<p>获取一个合法的session ID<br>在请求中加入相同的User-Agent头部,用与生成token<br>在请求中携带被攻击者的token<br>这里面有个问题。如果session id以及token都是通过GET数据来传递的话，那么对于能获取session ID的攻击者，同样就能够获取到这个token。所以，比较安全靠谱的方式应该是利用两种不同的数据传递方式来分别传递session id以及token。例如，通过cookie来传递session id,然后通过GET数据来传递token。因此，假如攻击者通过某种手段获得了这个唯一的用户身份标识，也是不太可能同时轻松地获取到这个token，它相对来说依然是安全的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/05/20181205-promise/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/05/20181205-promise/" itemprop="url">Promise</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-05T10:26:18+08:00">
                2018-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>Promise 新建后就会立即执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">let promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">    console.log(&apos;Promise&apos;);</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  console.log(&apos;Hi1!&apos;);</span><br><span class="line">  promise.then(function() &#123;</span><br><span class="line">    console.log(&apos;resolved.&apos;);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  console.log(&apos;Hi2!&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Promise</span><br><span class="line">Hi1!</span><br><span class="line">Hi2!</span><br><span class="line">resolved.</span><br></pre></td></tr></table></figure>
<p>上面代码中，Promise 新建后立即执行，所以首先输出的是Promise。然后，then方法指定的回调函数，将在当前脚本所有同步任务执行完才会执行，所以resolved最后输出。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/04/20181204-generator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/04/20181204-generator/" itemprop="url">generator函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-04T14:12:47+08:00">
                2018-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考阮一峰的文章：</p>
<p>调用 Generator 函数，会返回一个内部指针（即遍历器 ）g 。</p>
<p>调用指针 g 的 next 方法<br>执行开始：</p>
<ul>
<li>如果是第一个next，从函数入口开始执行</li>
<li>否则从上一次的yield停止的地方执行</li>
</ul>
<p>执行暂停并返回：遇到下一个yield语句（它的右侧表达式或函数是要执行的）<br>执行结束并返回：遇到return或函数结束</p>
<p>每次调用 next 方法，会返回一个对象，表示当前阶段的信息（ value 属性和 done 属性）。value 属性是 yield 语句后面表达式的值，表示当前阶段的值；done 属性是一个布尔值，表示 Generator 函数是否执行完毕，即是否还有下一个阶段。</p>
<p>Generator 函数可以暂停执行和恢复执行，这是它能封装异步任务的根本原因。除此之外，它还有两个特性，使它可以作为异步编程的完整解决方案：函数体内外的数据交换和错误处理机制。</p>
<h3 id="从内向外传数据"><a href="#从内向外传数据" class="headerlink" title="从内向外传数据"></a>从内向外传数据</h3><p>在yield右侧表达式中放入value值</p>
<h3 id="从外向内传数据"><a href="#从外向内传数据" class="headerlink" title="从外向内传数据"></a>从外向内传数据</h3><p>可以看作，调用next时传入参数，恰好是上一个yield的返回值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function* gen(x)&#123;</span><br><span class="line">  console.log(&quot;x=&quot;+x);</span><br><span class="line">  var y = yield x + 2;</span><br><span class="line">  console.log(&quot;y=&quot;+y);</span><br><span class="line">  return y+1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var g = gen(1);</span><br><span class="line">var funcp = g.next(5); // &#123; value: 5, done: false &#125;</span><br><span class="line">console.log(funcp);</span><br><span class="line">funcp = g.next(10); // &#123; value: 11, done: true &#125;</span><br><span class="line">console.log(funcp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x=1</span><br><span class="line">&#123; value: 3, done: false &#125;</span><br><span class="line">y=10</span><br><span class="line">&#123; value: 11, done: true &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">var foo= function *()&#123;</span><br><span class="line">console.debug(&apos;generator 1&apos;);</span><br><span class="line">console.debug(&apos;yield 1&apos;,yield &apos;A&apos;);</span><br><span class="line">console.log(&apos;generator 2&apos;);</span><br><span class="line">console.log(&apos;yield 2&apos;,yield &apos;B&apos;);</span><br><span class="line">console.log(&apos;generator 3&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const f3 = foo();</span><br><span class="line"></span><br><span class="line">console.log(&apos;tick1&apos;);</span><br><span class="line">console.log(f3.next(&apos;a&apos;));</span><br><span class="line">console.log(&apos;tick2&apos;);</span><br><span class="line">console.log(f3.next(&apos;b&apos;));</span><br><span class="line">console.log(&apos;tick3&apos;);</span><br><span class="line">console.log(f3.next(&apos;c&apos;));</span><br><span class="line">console.log(&apos;tick4&apos;);</span><br><span class="line">console.log(f3.next(&apos;d&apos;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tick1</span><br><span class="line">generator 1</span><br><span class="line">&#123; value: &apos;A&apos;, done: false &#125;</span><br><span class="line">tick2</span><br><span class="line">yield 1 b</span><br><span class="line">generator 2</span><br><span class="line">&#123; value: &apos;B&apos;, done: false &#125;</span><br><span class="line">tick3</span><br><span class="line">yield 2 c</span><br><span class="line">generator 3</span><br><span class="line">&#123; value: undefined, done: true &#125;</span><br><span class="line">tick4</span><br><span class="line">&#123; value: undefined, done: true &#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/02/20181202-lock-in-db/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/02/20181202-lock-in-db/" itemprop="url">数据库中的锁</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-02T22:20:17+08:00">
                2018-12-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>T1，T2假设是连个线程</p>
<h2 id="共享锁（shared-lock）"><a href="#共享锁（shared-lock）" class="headerlink" title="共享锁（shared lock）"></a>共享锁（shared lock）</h2><p>共享锁，就是表可以同时访问，一般就是查询<br>而数据库规定同一资源上不能同时共存共享锁和排他锁。所以T2必须等T1</p>
<h2 id="更新锁"><a href="#更新锁" class="headerlink" title="更新锁"></a>更新锁</h2><p>加上更新锁的意思就是我先做表查询，但马上要加上排他锁对记录进行更新<br>此时别人也可以查询，能加共享锁吗？可以</p>
<p>更新锁的意思是：“我现在只想读，你们别人也可以读，但我将来可能会做更新操作，我已经获取了从共享锁（用来读）到排他锁</p>
<p>（用来更新）的资格”。一个事物只能有一个更新锁获此资格。</p>
<p>T1执行select，加更新锁。</p>
<p>T2运行，准备加更新锁，但发现已经有一个更新锁在那儿了，只好等。</p>
<p>当后来有user3、user4…需要查询table表中的数据时，并不会因为T1的select在执行就被阻塞，照样能查询，相比起例6，这提高</p>
<h2 id="排他锁"><a href="#排他锁" class="headerlink" title="排他锁"></a>排他锁</h2><p>T1:</p>
<p>begin</p>
<p>select * from table(updlock) (加更新锁）</p>
<p>update table set column1=’hello’ (重点：这里T1做update时，不需要等T2释放什么，而是直接把更新锁升级为排他锁，然后执行update)</p>
<p>T2:</p>
<p>begin</p>
<p>select * from table (T1加的更新锁不影响T2读取）</p>
<p>update table set column1=’world’ (T2的update需要等T1的update做完才能执行)</p>
<p>我们以这个例子来加深更新锁的理解，</p>
<p>第一种情况：T1先达，T2紧接到达；在这种情况中，T1先对表加更新锁，T2对表加共享锁，假设T2的select先执行完，准备执行update，发现已有更新锁存在，T2等。T1执行这时才执行完select，准备执行update，更新锁升级为排他锁，然后执行update，执行完成，事务结束，释放锁，T2才轮到执行update。</p>
<p>第二种情况：T2先达，T1紧接达；在这种情况，T2先对表加共享锁，T1达后，T1对表加更新锁，假设T2 select先结束，准备update，发现已有更新锁，则等待，后面步骤就跟第一种情况一样了。</p>
<p>这个例子是说明：排他锁与更新锁是不兼容的，它们不能同时加在同一子资源上。排他锁（独占锁，Exclusive Locks)</p>
<p>这个简单，即其它事务既不能读，又不能改排他锁锁定的资源。</p>
<p>3，意向锁(Intent Locks)<br>意向锁就是说在屋（比如代表一个表）门口设置一个标识，说明屋子里有人（比如代表某些记录）被锁住了。另一个人想知道屋子</p>
<p>里是否有人被锁，不用进屋子里一个一个的去查，直接看门口标识就行了。</p>
<p>当一个表中的某一行被加上排他锁后，该表就不能再被加表锁。数据库程序如何知道该表不能被加表锁？一种方式是逐条的判断该</p>
<p>表的每一条记录是否已经有排他锁，另一种方式是直接在表这一层级检查表本身是否有意向锁，不需要逐条判断。显然后者效率高。</p>
<p>例12：</p>
<hr>
<p>T1: begin tran</p>
<p>select * from table (xlock) where id=10 –意思是对id=10这一行强加排他锁</p>
<p>T2: begin tran</p>
<p>select * from table (tablock) –意思是要加表级锁</p>
<p>假设T1先执行，T2后执行，T2执行时，欲加表锁，为判断是否可以加表锁，数据库系统要逐条判断table表每行记录是否已有排他锁，</p>
<p>如果发现其中一行已经有排他锁了，就不允许再加表锁了。只是这样逐条判断效率太低了。</p>
<p>实际上，数据库系统不是这样工作的。当T1的select执行时，系统对表table的id=10的这一行加了排他锁，还同时悄悄的对整个表</p>
<p>加了意向排他锁(IX)，当T2执行表锁时，只需要看到这个表已经有意向排他锁存在，就直接等待，而不需要逐条检查资源了。</p>
<p>例13：</p>
<hr>
<p>T1: begin tran</p>
<p>update table set column1=’hello’ where id=1</p>
<p>T2: begin tran</p>
<p>update table set column1=’world’ where id=1</p>
<p>这个例子和上面的例子实际效果相同，T1执行，系统对table同时对行家排他锁、对页加意向排他锁、对表加意向排他锁。</p>
<p>4，计划锁(Schema Locks)<br>例14：</p>
<hr>
<p>alter table …. (加schema locks，称之为Schema modification (Sch-M) locks</p>
<p>DDL语句都会加Sch-M锁</p>
<p>该锁不允许任何其它session连接该表。连都连不了这个表了，当然更不用说想对该表执行什么sql语句了。</p>
<p>例15:</p>
<hr>
<p>用jdbc向数据库发送了一条新的sql语句，数据库要先对之进行编译，在编译期间，也会加锁，称之为：Schema stability (Sch-S) locks</p>
<p>select * from tableA</p>
<p>编译这条语句过程中，其它session可以对表tableA做任何操作(update,delete，加排他锁等等），但不能做DDL(比如alter table)操作。</p>
<p>Bulk Update Locks 主要在批量导数据时用（比如用类似于oracle中的imp/exp的bcp命令）。不难理解，程序员往往也不需要关心，不赘述了。<br>3 何时加锁？<br>如何加锁，何时加锁，加什么锁，你可以通过hint手工强行指定，但大多是数据库系统自动决定的。这就是为什么我们可以不懂锁也可</p>
<p>以高高兴兴的写SQL。</p>
<p>例15:</p>
<hr>
<p>T1: begin tran</p>
<p>update table set column1=’hello’ where id=1</p>
<p>T2: SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED – 事物隔离级别为允许脏读</p>
<p>go</p>
<p>select * from table where id=1</p>
<p>这里，T2的select可以查出结果。如果事物隔离级别不设为脏读，则T2会等T1事物执行完才能读出结果。</p>
<p>数据库如何自动加锁的？</p>
<p>1) T1执行，数据库自动加排他锁</p>
<p>2) T2执行，数据库发现事物隔离级别允许脏读，便不加共享锁。不加共享锁，则不会与已有的排他锁冲突，所以可以脏读。</p>
<p>例16:</p>
<hr>
<p>T1: begin tran</p>
<p>update table set column1=’hello’ where id=1</p>
<p>T2: select * from table where id=1 –为指定隔离级别，则使用系统默认隔离级别，它不允许脏读</p>
<p>如果事物级别不设为脏读，则：</p>
<p>1) T1执行，数据库自动加排他锁</p>
<p>2) T2执行，数据库发现事物隔离级别不允许脏读，便准备为此次select过程加共享锁，但发现加不上，因为已经有排他锁了，所以就</p>
<p>等啊等。直到T1执行完，释放了排他锁，T2才加上了共享锁，然后开始读….</p>
<p>4 锁的粒度<br>锁的粒度就是指锁的生效范围，就是说是行锁，还是页锁，还是整表锁. 锁的粒度同样既可以由数据库自动管理，也可以通过手工指定hint来管理。</p>
<p>例17：</p>
<hr>
<p>T1: select * from table (paglock)</p>
<p>T2: update table set column1=’hello’ where id&gt;10</p>
<p>T1执行时，会先对第一页加锁，读完第一页后，释放锁，再对第二页加锁，依此类推。假设前10行记录恰好是一页(当然，一般不可能</p>
<p>一页只有10行记录），那么T1执行到第一页查询时，并不会阻塞T2的更新。</p>
<p>例18：</p>
<hr>
<p>T1: select * from table (rowlock)</p>
<p>T2: update table set column1=’hello’ where id=10</p>
<p>T1执行时，对每行加共享锁，读取，然后释放，再对下一行加锁;T2执行时，会对id=10的那一行试图加锁，只要该行没有被T1加上行锁，</p>
<p>T2就可以顺利执行update操作。</p>
<p>例19：</p>
<hr>
<p>T1: select * from table (tablock)</p>
<p>T2: update table set column1=’hello’ where id = 10</p>
<p>T1执行，对整个表加共享锁. T1必须完全查询完，T2才可以允许加锁，并开始更新。</p>
<p>以上3例是手工指定锁的粒度，也可以通过设定事物隔离级别，让数据库自动设置锁的粒度。不同的事物隔离级别，数据库会有不同的</p>
<p>加锁策略（比如加什么类型的锁，加什么粒度的锁）。具体请查联机手册。</p>
<p>5 锁与事物隔离级别的优先级<br>手工指定的锁优先，</p>
<p>例20:</p>
<hr>
<p>T1: GO</p>
<p>SET TRANSACTION ISOLATION LEVEL SERIALIZABLE</p>
<p>GO</p>
<p>BEGIN TRANSACTION</p>
<p>SELECT * FROM table (NOLOCK)</p>
<p>GO</p>
<p>T2: update table set column1=’hello’ where id=10</p>
<p>T1是事物隔离级别为最高级，串行锁，数据库系统本应对后面的select语句自动加表级锁，但因为手工指定了NOLOCK，所以该select</p>
<p>语句不会加任何锁，所以T2也就不会有任何阻塞。</p>
<p>6 数据库的其它重要Hint以及它们的区别<br>1) holdlock 对表加共享锁，且事物不完成，共享锁不释放。</p>
<p>2) tablock 对表加共享锁，只要statement不完成，共享锁不释放。</p>
<p>与holdlock区别，见下例：</p>
<p>例21</p>
<hr>
<p>T1:</p>
<p>begin tran</p>
<p>select * from table (tablock)</p>
<p>T2:</p>
<p>begin tran</p>
<p>update table set column1=’hello’ where id = 10</p>
<p>T1执行完select，就会释放共享锁，然后T2就可以执行update. 此之谓tablock. 下面我们看holdlock</p>
<p>例22</p>
<hr>
<p>T1:</p>
<p>begin tran</p>
<p>select * from table (holdlock)</p>
<p>T2:</p>
<p>begin tran</p>
<p>update table set column1=’hello’ where id = 10</p>
<p>T1执行完select，共享锁仍然不会释放，仍然会被hold(持有），T2也因此必须等待而不能update. 当T1最后执行了commit或</p>
<p>rollback说明这一个事物结束了，T2才取得执行权。</p>
<p>3) TABLOCKX 对表加排他锁</p>
<p>例23：</p>
<hr>
<p>T1: select * from table(tablockx) (强行加排他锁）</p>
<p>其它session就无法对这个表进行读和更新了，除非T1执行完了，就会自动释放排他锁。</p>
<p>例24：</p>
<hr>
<p>T1: begin tran</p>
<p>select * from table(tablockx)</p>
<p>这次，单单select执行完还不行，必须整个事物完成（执行了commit或rollback后）才会释放排他锁。</p>
<p>4) xlock 加排他锁</p>
<p>那它跟tablockx有何区别呢？</p>
<p>它可以这样用，</p>
<p>例25:</p>
<hr>
<p>select * from table(xlock paglock) 对page加排他锁</p>
<p>而TABLELOCX不能这么用。</p>
<p>xlock还可这么用：select <em> from table(xlock tablock) 效果等同于select </em> from table(tablockx)</p>
<p>7 锁的超时等待<br>例26</p>
<p>SET LOCK_TIMEOUT 4000 用来设置锁等待时间，单位是毫秒，4000意味着等待</p>
<p>4秒可以用select @@LOCK_TIMEOUT查看当前session的锁超时设置。-1 意味着</p>
<p>永远等待。</p>
<p>T1: begin tran</p>
<p>udpate table set column1=’hello’ where id = 10</p>
<p>T2: set lock_timeout 4000</p>
<p>select * from table wehre id = 10</p>
<p>T2执行时，会等待T1释放排他锁，等了4秒钟，如果T1还没有释放排他锁，T2就会抛出异常： Lock request time out period exceeded.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/20181129-devops/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/20181129-devops/" itemprop="url">20181129-devops</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T22:21:27+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>  收藏 128<br> 189<br>devops 编辑<br>本词条由“科普中国”百科科学词条编写与应用工作项目 审核 。<br>DevOps（Development和Operations的组合词）是一组过程、方法与系统的统称，用于促进开发（应用程序/软件工程）、技术运营和质量保障（QA）部门之间的沟通、协作与整合。<br>它是一种重视“软件开发人员（Dev）”和“IT运维技术人员（Ops）”之间沟通合作的文化、运动或惯例。透过自动化“软件交付”和“架构变更”的流程，来使得构建、测试、发布软件能够更加地快捷、频繁和可靠。<br>它的出现是由于软件行业日益清晰地认识到：为了按时交付软件产品和服务，开发和运营工作必须紧密合作。 [1]<br>中文名 过程、方法与系统的统称 外文名 DevOps 全    称 Development和Operations的组合 优    点 尽可能地自动化 用    途 协作与整合等<br>目录<br>1 发展介绍<br>2 现状<br>3 诉求<br>4 发布协调人<br>5 促进战略<br>6 批评<br>7 成功的关键<br>▪ 文化冲击<br>▪ 齐全工具箱<br>8 五大重点<br>9 三种便利<br>10 度量标准<br>11 使用技巧<br>12 与云混合方法<br>13 作用<br>14 工具<br>15 发展现状<br>16 大型机上使用<br>17 云应用安全<br>发展介绍编辑<br>DevOps: Development和Operations的组合<br>可以把DevOps看作开发（软件工程）、技术运营和质量保障（QA）三者的交集。<br>传统的软件组织将开发、IT运营和质量保障设为各自分离的部门。在这种环境下如何采用新的开发方法（例如敏捷软件开发），这是一个重要的课题：按照从前的工作方式，开发和部署不需要IT支持或者QA深入的、跨部门的支持，而却需要极其紧密的多部门协作。然而DevOps考虑的还不止是软件部署。它是一套针对这几个部门间沟通与协作问题的流程和方法。<br>需要频繁交付的企业可能更需要对DevOps有一个大致的了解。Flickr发展了自己的DevOps能力，使之能够支撑业务部门“每天部署10次”的要求──如果一个组织要生产面向多种用户、具备多样功能的应用程序，其部署周期必然会很短。这种能力也被称为持续部署，并且经常与精益创业方法联系起来。 从2009年起，相关的工作组、专业组织和博客快速涌现。<br>DevOps的引入能对产品交付、测试、功能开发和维护（包括──曾经罕见但如今已屡见不鲜的──“热补丁”）起到意义深远的影响。在缺乏DevOps能力的组织中，开发与运营之间存在着信息“鸿沟”──例如运营人员要求更好的可靠性和安全性，开发人员则希望基础设施响应更快，而业务用户的需求则是更快地将更多的特性发布给最终用户使用。这种信息鸿沟就是最常出问题的地方。<br>以下几方面因素可能促使一个组织引入DevOps：<br>1、使用敏捷或其他软件开发过程与方法<br>2、业务负责人要求加快产品交付的速率<br>3、虚拟化和云计算基础设施（可能来自内部或外部供应商）日益普遍<br>4、数据中心自动化技术和配置管理工具的普及<br>5、有一种观点认为，占主导地位的“传统”美国式管理风格（“斯隆模型 vs 丰田模型”）会导致“烟囱式自动化”，从而造成开发与运营之间的鸿沟，因此需要DevOps能力来克服由此引发的问题。<br>DevOps经常被描述为“开发团队与运营团队之间更具协作性、更高效的关系”。由于团队间协作关系的改善，整个组织的效率因此得到提升，伴随频繁变化而来的生产环境的风险也能得到降低。<br>DevOps对应用程序发布的影响<br>在很多企业中，应用程序发布是一项涉及多个团队、压力很大、风险很高的活动。然而在具备DevOps能力的组织中，应用程序发布的风险很低，原因如下 [2]  ：<br>（1）减少变更范围<br>与传统的瀑布式开发模型相比，采用敏捷或迭代式开发意味着更频繁的发布、每次发布包含的变化更少。由于部署经常进行，因此每次部署不会对生产系统造成巨大影响，应用程序会以平滑的速率逐渐生长。<br>（2）加强发布协调<br>靠强有力的发布协调人来弥合开发与运营之间的技能鸿沟和沟通鸿沟；采用电子数据表、电话会议、即时消息、企业门户（wiki、sharepoint）等协作工具来确保所有相关人员理解变更的内容并全力合作。<br>（3）自动化<br>强大的部署自动化手段确保部署任务的可重复性、减少部署出错的可能性。<br>与传统开发方法那种大规模的、不频繁的发布（通常以“季度”或“年”为单位）相比，敏捷方法大大提升了发布频率（通常以“天”或“周”为单位）<br>减少变更范围与传统的瀑布式开发模型相比，采用敏捷或迭代式开发意味着更频繁的发布、每次发布包含的变化更少。由于部署经常进行，因此每次部署不会对生产系统造成巨大影响，应用程序会以平滑的速率逐渐生长。加强发布协调靠强有力的发布协调人来弥合开发与运营之间的技能鸿沟和沟通鸿沟；采用电子数据表、电话会议、即时消息、企业门户（wiki、sharepoint）等协作工具来确保所有相关人员理解变更的内容并全力合作。强大的自动化部署手段能够确保部署任务的可重复性、减少部署出错的可能性。<br>现状编辑<br>很多组织将开发和系统管理划分成不同的部门。开发部门的驱动力通常是“频繁交付新特性”，而运营部门则更关注IT服务的可靠性和IT成本投入的效率。两者目标的不匹配，就在开发与运营部门之间造成了鸿沟，从而减慢了IT交付业务价值的速度 [3]  。<br>开发人员经常不考虑自己写的代码会对运营造成什么影响。他们在交付代码之前，并不邀请运营人员参与架构决策或代码评审。<br>开发人员对配置或环境进行修改之后，经常没有及时与运营人员沟通，导致新的代码不能运行。<br>开发人员在自己的机器上手工修改配置，而没有记录所有需要的步骤。想找到必要的配置参数，通常需要尝试很多不同的参数；在得到一个可工作的状态后，往往很难识别出通过哪些最小步骤就能到达该状态。<br>开发人员倾向于使用有利于快速开发的工具：对代码修改更快的反馈，更低的内存消耗，等等。这样的工具集与运营人员面对的目标运行时环境非常不同：后者对稳定性和性能的要求远胜于灵活性。<br>由于开发人员平时使用桌面电脑，他们倾向于使用为桌面用户优化的操作系统。生产环境的运行时系统通常都运行服务器操作系统上。<br>在开发过程中，系统在开发者的本地机器上运行。在运营过程中，系统经常分布在多台服务器上，例如web服务器、应用服务器、数据库服务器等等。<br>开发是由功能性需求（通常与业务需求直接相关）驱动的。<br>运营是由非功能性需求（例如可获得性、可靠性、性能等）驱动的。<br>运营人员希望尽量避免修改功能，从而降低满足非功能性需求的风险<br>如果拒绝了小的修改，但给定时间段内需要修改的总量不变，那么每次变更的规模就会变大<br>变更规模越大，风险也越大，因为其中涉及的区域越多<br>由于运营人员尝试避免变更，新功能流入生产环境的速度因此被延缓，从而延缓了开发人员将特性交付给用户使用的速度。<br>运营人员可能对应用程序内部缺乏了解，从而难以正确地选择运行时环境和发布流程。<br>开发人员可能对运行时环境缺乏了解，从而难以正确地对代码进行调整。<br>诉求编辑<br>1、更小、更频繁的变更──意味着更少的风险<br>2、让开发人员更多地控制生产环境<br>3、更多地以应用程序为中心来理解基础设施<br>4、定义简洁明了的流程<br>5、尽可能地自动化<br>6、促成开发与运营的协作<br>一般而言，当企业希望将原本笨重的开发与运营之间的工作移交过程变得流畅无碍，他们通常会遇到以下三类问题：<br>发布管理问题：<br>很多企业有发布管理问题。他们需要更好的发布计划方法，而不止是一份共享的电子数据表。他们需要清晰了解发布的风险、依赖、各阶段的入口条件，并确保各个角色遵守既定流程行事。<br>发布/部署协调问题：<br>有发布/部署协调问题的团队需要关注发布/部署过程中的执行。他们需要更好地跟踪发布状态、更快地将问题上升、严格执行流程控制和细粒度的报表。<br>发布/部署自动化问题：<br>这些企业通常有一些自动化工具，但他们还需要以更灵活的方式来管理和驱动自动化工作──不必要将所有手工操作都在命令行中加以自动化。理想情况下，自动化工具应该能够在非生产环境下由非运营人员使用。<br>要开始优化发布流程，可以从问题识别开始：看看上面提到的哪种问题在你的团队中具有最高的优先级。<br>发布协调人编辑<br>这是企业级IT组织中一个新出现的角色，其主要任务就是协调安排将企业级软件部署到预生产环境。对发布协调人的需求来自于以下几方面原因：<br>1、需要弥合开发与运营的鸿沟<br>2、基础设施日益变得复杂：为了运营web应用，需要多层基础设施和多种平台<br>3、发布频率上升（由于敏捷和迭代式开发的引入）<br>4、分布式团队：位于全球多个地点的、包含外包人员的、混合开发/测试/基础设施的团队<br>发布协调人的角色（也被称为部署协调人或集成协调人）源自发布管理或发布工程团队。这个角色与航空交通管制有些类似──实时协调不同团队的行动，有效使用共享的资源（空域、航道、跑道、航站门），达到组织的总体目标（安全起降）。<br>传统意义上的发布管理往往只关注软件变更的计划与管理，发布协调则需要控制“将特定软件变更发布至生产环境”的整个过程。这项工作需要系统地管理所有与“将代码构建并部署到生产环境”相关的技术任务，也被称为“发布工程”。<br>变更管理是跟踪企业IT环境中各种变化──不管是应用程序还是基础设施的变化──的基本原则。变更管理是ITIL v3的核心之一。<br>促进战略编辑<br>想要为DevOps和应用灵活性而重塑团队，需要领导层的勇气和无私奉献。当然，它也需要花费时间和金钱，并且需要在团队成员筛选上做出艰难的决定。<br>为了促进DevOps战略，调整考核和激励机制是必要的。如果依然只根据敲出代码的生产力来奖励开发人员，或者根据基础设施的可靠性来奖励运维人员，那么，什么都不会改变。相反，应该奖励系统创建和运维的整体团队，并且根据团队工作的全部要素来确定奖励。<br>围绕业务系统而不是职责来组织工作，这就是DevOps打破IT分组壁垒的寓意。一个团队应该有开发人员创建代码，从用户界面到业务逻辑和数据结构，也应该有运维人员负责操作自动化和部署。<br>人们需要知道他们需要对什么样的系统负责，而并不仅仅是毫无责任地从一个系统换到另一个系统。<br>团队待在一起，共同为他们的应用和系统负责。<br>不要制造一个团队支持太多应用的局面。在这个预算缩减的年代很难考虑周全，但是经历这种融合转变之后，团队将更加富有成效，并且不需要额外人员就能应对需求的增长。<br>需要充足的专家参与项目和为团队提供支持 ——这些人都是不同学科的大师和专家。他们为系统提供支持，但是不会长期指派给某一个系统。他们不需要对这些系统负责。<br>全面自动化 —— 部署、 升级、 扩展、 维护、 数据卫生、 测试、 监测、 安全和策略管理。在自动化方面投入巨资，目标是100%的自动化，不考虑低于90%的可能性。但是，全面自动化也可能会引起自动化泛滥。集中审查和调整可以控制Chef或Puppet脚本库的无序增长。<br>针对整个团队进行奖励和表彰。成功离不开大家共同的努力，同样，问题需要整个团队自我反省。系统团队应该承认专家们的贡献 ，对表现杰出的专家给予奖励。<br>围绕建设运营融合的原则制定新的企业体系结构标准。这将确保系统符合运维的需求。<br>DevOps战略必须获取本组织自顶向下的全面支持。整个行政领导团队 ——不只是首席信息官 ——应知道它为什么重要和怎样使它取得成功。<br>请记住，这是重大的文化和组织变革，多分配些时间开展培训和组织开发活动。如果变革得太快而忘了和您的所有团队步调一致，将整天陷入失误和冲突——最后满盘皆输。 [4]<br>批评编辑<br>有IT博客对“DevOps”这个标签进行了批评，认为它不过是系统管理员的精英至上论俱乐部在老调重谈一些现有的问题（参见“对此运动的批评”）。<br>成功的关键编辑<br>文化冲击<br>平稳的文化过渡是让DevOps获得长期成功应用和增强发布软件产品的综合能力的关键。第一步是，明确DevOps的定义，调动开发和运营部门之间的协作，鼓励运营人员采纳软件开发方法，并利用云计算基础设施来完成真实的测试和代码部署。<br>在软件开发、测试、质量保证（QA）、集成、预生产和生产部署等方面的任何旧小团队必须打散，因为每个小团队都可能拖延开发周期并且带来不可预料的问题。<br>以上策略能更好地整合开发和运营人员，通过整合团队成员来产生效益。例如，在讨论运营解决方案或扰乱事后评估报告时应该邀请开发人员加入。相反地，应该邀请运营人员列席开发人员规划会议。让交叉组合的工作模式成为制度，可以让团队之间合作融洽，消除沟通不畅导致的延误或疏忽，使DevOps的推进更加有效。<br>这种文化上的改革并不容易。它需要公司提供统一的考核标准，以相同的形式衡量开发人员和运维人员的业绩。培养一种团队精神，让大家一起向一个共同的目标努力，而不再只是为了从前各自的狭隘的小团体目标。在这里有时可以运用岗位轮换或者知识共享的方法<br>齐全工具箱<br>想要超越文化的影响，组织还必须依靠各种 DevOps 工具。例如，开发人员编写代码需要工具、QA测试人员需要用工具完成新版软件的部署，环境准备、将新代码在测试系统和生产系统之间迁移也必须用到云资源调度工具。Fletcher表示，工具本身都不是问题，重要的是能够让各种工具互相配合，在软件的生命周期内提供支持。<br>当前在应用程序发布自动化工具市场已经存在众多的供应商。运营工具方面的供应商有BMC Software, CA Technologies Inc. 和 XebiaLabs Inc.等公司。软件开发工具方面的供应商包括IBM，Electric Cloud Inc.和Serena Software Inc。<br>关于开发人员工作流程、架构设计和软件发布工具方面的专业供应商也在不断涌现，这些供应商包括Atlassian, CollabNet Inc., Rally Software, ThoughtWorks Inc. ，OpenMake Software Inc.等公司。在评估这些新供应商时，应明智地预计到这些公司随时可能会被并购，其产品可用性和未来发展也会因此受影响——请记得在选择新的软件发布自动化产品时多留个心眼。 [5]<br>五大重点编辑<br>1、警惕总体安全风险。虚拟化、云、BYOD以及软件定义网络（SDN）等新兴技术不断得到采用意味着网络变得越来越复杂，愈发的异构化，安全风险也是如此。这其中的巨大挑战是迄今为止，安全被视为是事后想法，而安全组织又被认为是企业的抑制因子，只会告诉企业什么做不了而不是如何安全地做事情。这是一个文化问题，需要安全、开发者以及运营团队培育出此前未有过的一定水平的信任和协作。做到这一点的唯一办法是逐步地、带着警惕地去做。 [6]<br>2、观察安全风险变化，把DevOps看作一种可将开发者和IT运营引向更快更高效的部署、运营及升级应用的协作理念和流程很重要。<br>3、注意可伸缩性。企业和技术的人必须在功能、推向市场的时间、成本以及风险承受能力等方面做出权衡。你需要有合适的衡量目标，包括特定模式下的那些端点上有多少用户，有多少并发请求。<br>4、争取实现易用—DevOps就是自动化和可重复性。<br>5、管理网关。尽管新的目标是在开发和运营团队之间建设最好的文化，但为了确保产品环境保持稳定，在这两个职能之间保留一些网关仍然是好的。 [6]<br>三种便利编辑<br>将人置于技术之前<br>投资在那些关注技术的使用，以及如何采用持续开发、测试、集成、部署和操作的培训计划上。<br>安全和管理<br>对云应用开发的管理必须是系统性的，构建在DevOps流程中的每一步，包括对使用的服务或API，以及服务发现和服务的依赖上所做的限制的政策。<br>作出改变<br>DevOps需要改变和发展以跟上新兴的理念和技术。在设计你的DevOps流程时始终要将变化考虑在内。 [7]<br>度量标准编辑<br>●<br>开发应用所花费的最高时间：帮助理解可以多快的开发应用<br>●<br>失败部署的百分比：看出是否部署成功<br>●<br>客户ticket数：显示产生了多少问题<br>●<br>故障恢复的平均时间：显示从应用程序bug或者故障恢复需要多长时间<br>●<br>用户数：显示应用程序对于用户而言的有用程度 [8]<br>使用技巧编辑<br>Web服务器负载飙升的分析与处理<br>前提：日志已经通过logrotate按天切分，其内容类似下面的样子：<br>1.2.3.4 - - [01/Jan/2013:00:01:01 +0800] “GET /path HTTP/1.1” …<br>利用AWK，我们可以很方便的计算一天中每分钟的访问量是多少：<br>shell&gt; awk -F: ‘ {count [$2”:”$3]++}<br>　　END {for (minute in count) print minute, count [minute] } ‘ /path/to/log | sort &gt; count.log<br>下面列出生成的count.log文件中的部分数据，结果一目了然，不多说了：<br>18:55 14450<br>　　18:56 14926<br>　　18:57 15645<br>　　18:58 16678<br>　　18:59 19032<br>　　19:00 29134<br>　　19:01 34665<br>　　19:02 35558<br>　　19:03 35545<br>　　19:04 35829<br>　　19:05 35608<br>如果想要以秒为单位来统计，也是类似的方法。 [9]<br>与云混合方法编辑<br>步骤一：使用云友好工具<br>DevOps的是客户托管的命令中心，在这之中每一个管理服务器都直接连接。对于一个可访问命令中心的新实例，它所需要的只是在本地服务器上的代理运行。这很容易就陷入到云实例中。有了与应用、数据库和配置信息命令绑定的解决方案，那么跨云进行无论是小的，还重大的更改都很容易。<br>步骤二：不要忘本<br>虽然自动化将会变得越来越重要，但了解发生的什么还是很重要的。这意味着要掌握部署流程的所有步骤。否则，在解决故障或定制化你的自动化工具时，你就是在抓瞎。<br>步骤三：对团队进行培训<br>随着云和新的工具承担了大量的工作负载，运维工作似乎变得越来越不重要。但同时随着云复杂性的增加，实际上很难找到合格的运维人员。在真实世界中的持续应用管理备受关注，而且找到适合大局的人很关键。尽可能地让你的开发人员学到更多关于运维的知识可以消除一些痛点，因为在他们的编程中他们可以做出更明智的选择，从而避免常见错误。 [10]<br>作用编辑<br>DevOps是Develop与Operations的缩写，它是企业内开发、技术运营和质量保障这三方面工作的融合，用于促进开发、技术运营和质保部门之间的沟通、协作与整合。有研究显示，在那些引入了DevOps概念的企业中，开发与运营人员在设计、构建、测试工作中共同在内部应用上进行协作之后，可以将产品开发的效率提升20%。<br>然而最为重要的如何成为一名真正的消费者用户并像消费者用户那样来考虑这整件事情的意义所在，无论是成为企业内部用户的还是外部用户。事实上，如何提升最终用户体验一直是DevOps战略发展的第一驱动力，有68%的企业是这样认为的，第二个需求是为了提升开发与运营团队之间的协作水平与效率，有61%的受访者选择了这一项。企业的移动与云计算转型趋势的兴起，同样也是企业引入DevOps的重要原因，有52%与43%的人分别选择了这两项。 [11]<br>工具编辑<br>即便是具有最高度功能化的DevOps团队也是需要第三方工具来管理诸如云计算这类的分布式环境。对于这样的环境来说，某些工具是特别有用的。<br>诸如FlowDock或HipChat这样的DevOps实用工具能够帮助开发团队的成员互相以及与DevOps人员保持联系。诸如Asana或Basecamp这类服务能够有助于跟踪开发任务以及在应用发布中的注意事项。<br>诸如以客户为中心的支持门户网站可让用户直接与管理层或开发团队进行需求沟通。这将有助于触发新的或改进的功能，并确保客户的需求能够得到满足。一个DevOps团队能够帮助建立这些服务，并让团队成员了解相关技术。 [12]<br>无论是纵向集成还是横向集成，DevOps都需要通过工具链与持续集成、交付、反馈与优化进行端到端整合。华为基于二十几年的研发实践，并融合DevOps等理念方法，打造了软件开发云服务，希望为企业提供一站式的云上开发工具平台。据了解，华为软件开发云提供了项目管理、配置管理、代码检查、编译构建、测试、部署、发布等端到端地覆盖软件生命周期的相关服务。 [13]<br>发展现状编辑<br>在云计算、大数据等技术颠覆性趋势继续在应用经济下发挥作用的同时，DevOps也已经稳健地在业务思维方式中占有一席之地，并将在2015年扮演主要角色。在应用驱动、云连接、移动化的大环境下，DevOps战略将助力业务增值。2015年对于很多公司来说是DevOps之路的第一步。<br>紧跟行业趋势、进行新的技术变革往往会带来发展的阵痛，DevOps也同样要经历这一过程。中国及全球各地的企业正在认识到DevOps可以助力软件开发速度加快，软件应用质量提升，更重要的是与业务目标更完美地结合。如果说，2014年DevOps还在谋求广泛的认可，那么2018年DevOps将走到舞台中心，被整合成为企业战略的重要组成部分。 [14]<br>改变流程促进软件质量的改进<br>与DevOps相伴的一个变化是向持续集成的演进。软件开发和部署的速度是其中一个驱动因素，使得开发和运维的合并不是空谈而成为必需。 [15]<br>大型机上使用编辑<br>devops加快交付速度<br>devops填补了之前的空白部分，devops通过建立一个完整的生命活动周期，devops关注如何更好地获取IT运维团队的反馈。devops将敏捷原则应用于管理领域，devops使得开发人员和管理员可以进行毫无障碍的沟通。<br>devops还有很多不足，devops导致代码交接容易出现延迟。devops同样的情况也会出重大bug的修复过程中。<br>devops运行时软件优化<br>devops可以在两个方面提升知识水平和程序质量。首先，devops对于许多较新的、面向对象的操作系统，比如Linux，devops很有可能不关机而一直保持运行状态。因此，devops容易出现问题，比如错误的垃圾回收机制以及不能正确重新组织关系型数据存储。<br>devops借鉴了大型机管理员积累的经验来重新认识软件平台类型，以及可能引起这些类型问题的开发和/或测试流程。devops开发团队可以使用嵌入式模式保护代码来部署代码库和测试环境。<br>devops的目标是在测试环境中，或者devops以代码的形式嵌入到应用程序自身当中以获取大型机复杂性的现有知识，devops不希望大型机管理员发现问题所在。devops并不仅可以使得开发人员和测试人员的工作更加轻松，同样可以简化管理员的工作。<br>devops提高大型机管理员工作效率<br>devops可以改善这种大型机管理模式，devops提高大型机管理员的工作效率。首先，devops通过实现标准配置和Linux相关任务的自动化，devops可以保证管理员拥有更多时间来“救火”。devops通过确保解决方案是长期有效和高质量的来减少对于处理紧急情况的处理需求。此外，devops让管理员也参与敏捷开发流程，和开发团队进行沟通，当开发团队拥有了一个能够快速定位问题并且修复运行时问题的测试工具或者代码库之后，devops就可以减少管理员修复bug以及与开发部门协调所花费的时间。 [16]<br>云应用安全编辑<br>1.自动化手动安全测试<br>自动化在DevOps中很重要因为它提供了准确性和速度。应用交付需要高效，而手动安全测试就是不够快。更重要的是，第三方在外部手动测试中往往会漏掉测试错误。<br>尽管组织不需要完全抛弃手动测试，他们应该将自动化过程提上日程。安全团队应该确定如何自动实施他们的手动过程。当嵌入坚固DevOps到你现有的云环境中时，对安全测试工具进行审核以确保可以将其加入到持续集成和应用交付过程中。然后，删除或替换不适合DevOps的工具或者不能与你的云业务集成的工具。<br>2．尽早优先处理安全性<br>尽管IT行业采用敏捷和DevOps过程的比例很大，安全测试周期仍然还是基于传统繁琐的瀑布模型。这意味着许多组织忘记做安全资格测试，如PCI检查和风险评估，直到几乎为时已晚。为了更有效地同步安全和DevOps周期，从开发过程一开始就进行安全测试。<br>3．建立跨职能团队参与<br>实施坚固DevOps，安全团队需要开发和运营团队紧密合作。当这么做时，安全专家应该保持开放的心态去了解他们同事的文化和语言。这样，这种关系就成了一种真正的伙伴关系而不是一种机械的形式。</p>
<ol>
<li>在运营中嵌入安全工具<br>在一个坚固DevOps模型中，安全团队应该让组织的其他部门也了解安全工具。通过分享技术知识，企业将有更广阔的劳动力，可以解决在第一线的安全问题。为了帮助小的安全团队在更大的DevOps组织内扩展其业务影响力，可以把安全工具包括在通用的操作工具包里。<br>5．监控和审计集成过程<br>紧密监控和记录集成和交付流程，以确保高质量的软件。这也有助于识别安全问题。使用粒度变化日志为审计人员准备信息，以及可扩展的云安全监测工具。这些工具应能够自动跟踪和测量新添加的资源。此外，它们应汇总监测数据和快速检测实际的问题，同时消除误报。 [17]<br>参考资料</li>
<li>DevOps  ．维基百科[引用日期2014-03-01]</li>
<li>霍娜. 2017年DevOps三大趋势预测[N]. 中国信息化周报,2017-03-06(024).</li>
<li>牛晓玲,吴蕾.DevOps发展现状研究[J].电信网技术,2017(10):48-51.</li>
<li>重塑IT组织 实现DevOps战略  ．TechTarget数据中心．2013-10-22[引用日期2015-01-21]</li>
<li>DevOps成功的两个关键  ．TechTarget[引用日期2015-07-11]</li>
<li>五大DevOps最佳实践实现安全、可伸缩和性能  ．TechTarget[引用日期2015-08-12]</li>
<li>DevOps实施的三种IT障碍  ．TechTarget云计算[引用日期2016-03-24]</li>
<li>跟踪DevOps指标 增加业务敏捷度  ．TechTarget[引用日期2015-09-17]</li>
<li>DevOps的三板斧  ．TechTarget[引用日期2015-10-31]</li>
<li>云计算如何牵手DevOps提升生产率？  ．TechTarget[引用日期2015-10-31]<br>展开全部<br>词条标签：<br>科学 ， 学科</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/29/20181129-restful-api-principles/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/20181129-restful-api-principles/" itemprop="url">restful api 的设计准则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-29T21:54:54+08:00">
                2018-11-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="RESTful-API教程：学习关键的Web服务设计原则"><a href="#RESTful-API教程：学习关键的Web服务设计原则" class="headerlink" title="RESTful API教程：学习关键的Web服务设计原则"></a>RESTful API教程：学习关键的Web服务设计原则</h2><p>来自公众号EAWorld。</p>
<p><a href="https://www.theserverside.com/video/A-RESTful-APIs-tutorial-Learn-key-web-service-design-principles" target="_blank" rel="noopener">RESTful APIs tutorial: Learn key web service design principles</a></p>
<h3 id="原则："><a href="#原则：" class="headerlink" title="原则："></a>原则：</h3><ul>
<li>有意义的、唯一的URL，</li>
<li>GET不进行写操作，</li>
<li>PUT和DELETE要具备幂等性</li>
<li>审慎的使用POST。</li>
</ul>
<h3 id="有意义的、唯一的URL，"><a href="#有意义的、唯一的URL，" class="headerlink" title="有意义的、唯一的URL，"></a>有意义的、唯一的URL，</h3><p><strong>我们强调的第一个重要原则是，资源应该始终通过惟一标识它们的URL访问</strong> </p>
<p>如果RESTful JavaScript客户端只对wins感兴趣，URL应该遵循可预测的格式，其中wins是score的子资源：<br><a href="http://www.mcnz.com/rps/score/wins" target="_blank" rel="noopener">www.mcnz.com/rps/score/wins</a> → returns { “wins”:”5”}<br>事实上，返回JSON格式的wins可能有点过头了。只要将wins的数目以文本格式返回即可，所有客户端都可以轻松地使用该结果，而不管它们是否可以解析JSON。因此，最好采取以下措施：<br><a href="http://www.mcnz.com/rps/score/wins" target="_blank" rel="noopener">www.mcnz.com/rps/score/wins</a> → returns “5”<br>looses和ties应该遵循类似的RESTful URL格式：<br><a href="http://www.mcnz.com/rps/score/losses" target="_blank" rel="noopener">www.mcnz.com/rps/score/losses</a> → returns “3”<br><a href="http://www.mcnz.com/rps/score/ties" target="_blank" rel="noopener">www.mcnz.com/rps/score/ties</a> → returns “0”</p>
<h3 id="RESTful设计规则：GET调用不能改变服务器状态"><a href="#RESTful设计规则：GET调用不能改变服务器状态" class="headerlink" title="RESTful设计规则：GET调用不能改变服务器状态"></a>RESTful设计规则：GET调用不能改变服务器状态</h3><p>首要原则是，GET调用永远不能改变服务器上任何RESTful资源的状态。</p>
<h3 id="RESTful-PUT和DELETE方法需要遵守幂等原则"><a href="#RESTful-PUT和DELETE方法需要遵守幂等原则" class="headerlink" title="RESTful PUT和DELETE方法需要遵守幂等原则"></a>RESTful PUT和DELETE方法需要遵守幂等原则</h3><p>虽然并不是一个严格的规则，但PUT和DELETE方法大致映射了保存和删除的概念。如果设计人员想要从服务器中删除资源，他们应该使用HTTP DELETE方法。如果需要创建新资源或需要更新现有资源，则应使用PUT方法。</p>
<p>PUT和DELETE方法对于保存和删除数据来说是相对简单的。但这也是RESTful Java API设计人员经常遇到麻烦的另一个陷阱。这就引出了第二条规则：HTTP方法要具备幂等性。<br>如果某件事是幂等的，意味着它可以重复进行，但结果总是一样的。</p>
<p>例如，假设客户端发出RESTful DELETE请求删除编号为271的记录。这个调用可进行一次，也可能进行100次。无论如何，最终的结果必须是一样的，即编号271的寿终正寝。下面的场景就是幂等的。</p>
<p>HTTP DELETE || <a href="http://www.mcnz.com/rps/score?record=271" target="_blank" rel="noopener">www.mcnz.com/rps/score?record=271</a> #Good RESTful Java design</p>
<p>反例是，删除数据库中最老的10条记录的请求。</p>
<p>HTTP DELETE || <a href="http://www.mcnz.com/rps/score?oldRecordsToDelete=10" target="_blank" rel="noopener">www.mcnz.com/rps/score?oldRecordsToDelete=10</a> #Bad RESTful Java design</p>
<p>在反例中，RESTful URL将使数据库在每次新调用时处于不同的状态,直至删除数据库中的每条记录。这个方法不是幂等的，因此违反了基本的RESTful API原则。</p>
<p>PUT方法也必须是幂等的。因此，如果需要将wins的数量从数据库中的当前值更改为10，那么一个好的RESTful Java API将如下所示：</p>
<p>HTTP PUT || <a href="http://www.mcnz.com/rps/score/wins?value=10" target="_blank" rel="noopener">www.mcnz.com/rps/score/wins?value=10</a></p>
<p>我们可以一次又一次地调用此方法，每次调用之后，服务器将处于相同的状态：wins的得分是10。这个RESTful Java API是幂等的。反例是，每次调用该方法时添加10次win：</p>
<p>HTTP PUT || <a href="http://www.mcnz.com/rps/score/wins?add=10" target="_blank" rel="noopener">www.mcnz.com/rps/score/wins?add=10</a></p>
<p>这个方法不是幂等的，因为每次调用时，wins的数目会跳转到一个新的值。wins的得分开始时是10，第二次调用时20次，下一次30次。使用此方法，资源的最终状态是不可预测的。它不是幂等的，也不是好的RESTful API设计。</p>
<p>从技术上讲，URL末尾的查询参数应该仅用于查询。在本例中，我们使用查询参数向服务器传递有效负载。这样做使示例更简单，但也突破了查询参数本来的用途。在未来的RESTful API设计教程中，我们将演示如何在PUT调用期间将JSON字符串作为有效负载的一部分来进行传递，这是比使用查询参数更好的设计。</p>
<h3 id="保守的使用RESTful-API设计的瑞士军刀：POST方法"><a href="#保守的使用RESTful-API设计的瑞士军刀：POST方法" class="headerlink" title="保守的使用RESTful API设计的瑞士军刀：POST方法"></a>保守的使用RESTful API设计的瑞士军刀：POST方法</h3><p>我们已经知道，从数据库中删除10条最老的记录是对DELETE方法的错误使用，而简单的数字增量则是PUT方法的糟糕应用，这是否意味着我们不能用RESTful API来完成这些事情？当然不是。</p>
<p>目前为止，我们建立了两个非常重要的规则：</p>
<p>GET调用不能更改资源的状态。</p>
<p>PUT和DELETE方法必须是幂等的。</p>
<p>但是请注意，我们还没有提到POST方法。在上述规则之外的任何场景中，都可以使用POST方法。因此，如果要从数据库中删除10条最老的记录，可以使用POST方法。如果想将wins得分加10，同样可以使用POST方法。POST方法，从某种意义上讲，是RESTful设计的瑞士军刀。</p>
<p>HTTP POST || <a href="http://www.mcnz.com/rps/score/wins?add=10" target="_blank" rel="noopener">www.mcnz.com/rps/score/wins?add=10</a> </p>
<p>HTTP POST || <a href="http://www.mcnz.com/rps/score?oldRecordsToDelete=10" target="_blank" rel="noopener">www.mcnz.com/rps/score?oldRecordsToDelete=10</a> </p>
<p>过度使用POST方法本身也是RESTful设计的误区之一。<br>通常，我们会看到一个被认为是RESTful的系统中，设计人员投机取巧地将API的所有排列都设计为POST调用。仅仅因为没有违反重要的RESTful原则，并不意味着已经开发了一个有效的RESTful API。当RESTful API设计者对他们的问题域采取“基于服务”的方法时，经常会出现频繁使用POST方法的趋势。创建RESTful API时，始终在系统中应用“基于资源”的方式十分重要。</p>
<p>白小白：<br>此处实际上稍微令人费解，原因在于基于服务和基于资源的概念在本文中并未明确的给出解释。其实可以将此区别理解为传统的SOAP与REST的区别之一，这里有一篇文章我觉得写的很好（ <a href="https://blog.csdn.net/caisini_vc/article/details/48465731" target="_blank" rel="noopener">https://blog.csdn.net/caisini_vc/article/details/48465731</a> ）。比如，一个删除用户的操作，在基于服务的模式下，所有的 SOAP 消息经过代理服务器，只能看到（<a href="http://localhost:8182/v1/soap/servlet/messagerouter" target="_blank" rel="noopener">http://localhost:8182/v1/soap/servlet/messagerouter</a>, HTTP POST）这样的信息，如果代理服务器想知道当前的 HTTP 请求具体做的是什么，必须对 SOAP 的消息体解码。而在基于资源的模式下，URL的描述是（<a href="http://localhost:8182/v1/users/{username}，DELETE），这不仅有利于服务器的识别，更可以实现安全控制。" target="_blank" rel="noopener">http://localhost:8182/v1/users/{username}，DELETE），这不仅有利于服务器的识别，更可以实现安全控制。</a><br>还有很多需要学习的东西，比如将有效负载数据传递给服务器的最佳实践，如何构造URL以识别资源，以及如何避免在“基于资源的设计”中应用了“基于服务的方法”这样的误区。我们将在随后的RESTful API教程中介绍这些内容。但是，构建URL和正确使用HTTP方法是每一个优雅的“基于资源的API”设计的坚实基础。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/26/20181126-git-cancel-update/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/26/20181126-git-cancel-update/" itemprop="url">git中的撤销更改</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-26T22:37:13+08:00">
                2018-11-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="git-提交更改"><a href="#git-提交更改" class="headerlink" title="git 提交更改"></a>git 提交更改</h3><p>git commit只负责把暂存区的修改提交了</p>
<p>第一次修改 -&gt; git add -&gt; 第二次修改  -&gt; git commit</p>
<p>当你用git add命令后，在工作区的第一次修改被放入暂存区，准备提交，但是，在工作区的第二次修改并没有放入暂存区，所以，也就是第一次的修改被提交了，第二次的修改不会被提交。</p>
<h3 id="撤销更改"><a href="#撤销更改" class="headerlink" title="撤销更改"></a>撤销更改</h3><ul>
<li><p>场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令git checkout – file。</p>
</li>
<li><p>场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令git reset HEAD <file>，就回到了场景1，第二步按场景1操作。</file></p>
</li>
<li><p>场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考版本回退一节，不过前提是没有推送到远程库。</p>
<h4 id="撤销当前文件（工作区）"><a href="#撤销当前文件（工作区）" class="headerlink" title="撤销当前文件（工作区）"></a>撤销当前文件（工作区）</h4><p>命令<code>git checkout -- readme.txt</code>意思就是，把readme.txt文件在工作区的修改全部撤销，这里有两种情况：</p>
</li>
<li><p>一种是readme.txt自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；</p>
</li>
<li>一种是readme.txt已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。</li>
</ul>
<p>总之，就是让这个文件回到最近一次git commit或git add时的状态。</p>
<p><code>git checkout -- file</code>命令中的–很重要，没有–，就变成了“切换到另一个分支”的命令，我们在后面的分支管理中会再次遇到git checkout命令。</p>
<h4 id="撤销暂存区到"><a href="#撤销暂存区到" class="headerlink" title="撤销暂存区到"></a>撤销暂存区到</h4><p>用git add 把错误文件加到暂存区了，还没有提交<br><br>Git同样告诉我们，用命令<figure class="highlight plain"><figcaption><span>reset HEAD <file>```可以把暂存区的修改撤销掉（unstage），重新放回工作区</file></span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意此时暂存区是干净的，工作区是修改状态</span><br><span class="line"></span><br><span class="line">然后用 `git checkout -- xx.xxxfile`放弃工作区修改，恢复到原始状态 </span><br><span class="line"></span><br><span class="line">### 从当前版本回退</span><br></pre></td></tr></table></figure></p>
<p>git reset –hard HEAD~100 //回退100步<br>git reset –hard HEAD^ //从当前版本回退一步<br>git reset –hard edadfc<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### git add</span><br><span class="line"></span><br><span class="line">git 2.x</span><br><span class="line">``` </span><br><span class="line">git add -A  //stage All</span><br><span class="line">git add .   //stage All</span><br><span class="line">git add . </span><br><span class="line">git add -u  // Stage modified and deleted files</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ git checkout -- readme.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>
<h3 id="修改-gt-git-add-gt-修改-gt"><a href="#修改-gt-git-add-gt-修改-gt" class="headerlink" title="修改-&gt;git add -&gt;修改 -&gt;"></a>修改-&gt;git add -&gt;修改 -&gt;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">####  修改，</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line">$ git add readme.txt</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line"></span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line"></span><br><span class="line">$ git checkout -- readme.txt</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line"></span><br><span class="line">$ git reset HEAD readme.txt</span><br><span class="line">Unstaged changes after reset:</span><br><span class="line">M	readme.txt</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">	modified:   readme.txt</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br><span class="line">$ git checkout -- readme.txt</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>
<p>##关联远程库<br>要关联一个远程库，使用命令git remote add origin git@server-name:path/repo-name.git；</p>
<p>关联后，使用命令git push -u origin master第一次推送master分支的所有内容；</p>
<p>此后，每次本地提交后，只要有必要，就可以使用命令git push origin master推送最新修改；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/26/20181126-uml-in-markdown/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/26/20181126-uml-in-markdown/" itemprop="url">文档中用代码绘制UML图</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-26T22:32:20+08:00">
                2018-11-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>分析或设计文章中，通过uml图能更清楚的表达概念，一图胜过一段话。</p>
<p>可是uml图如何纳入代码管理呢？<br>可以通过各种标记行语言，通过工具自动生成图</p>
<h2 id="常用的uml绘图语言"><a href="#常用的uml绘图语言" class="headerlink" title="常用的uml绘图语言"></a>常用的uml绘图语言</h2><h3 id="plantuml"><a href="#plantuml" class="headerlink" title="plantuml"></a>plantuml</h3><h3 id="mermaid"><a href="#mermaid" class="headerlink" title="mermaid"></a>mermaid</h3><h3 id="yUML"><a href="#yUML" class="headerlink" title="yUML"></a>yUML</h3><h2 id="在哪写？"><a href="#在哪写？" class="headerlink" title="在哪写？"></a>在哪写？</h2><p>markdown是文档最好的载体</p>
<p>写markdown的工具很多，现在用vscode就非常好</p>
<p>vscode中安装插件  Markdown Preview Enhanced</p>
<p>打开预览的快捷键  command+k,v</p>
<h2 id="怎么写"><a href="#怎么写" class="headerlink" title="怎么写"></a>怎么写</h2><p>在vs code中使用Markdown Preview Enhanced插件，可以支持Flow Charts，Sequence Diagrams，Mermaid， PlantUML<br>，WaveDrom，GraphViz</p>
<p>如果你只是想要显示代码块而不想画图，则只要在后面添加 {code_block=true} 即可：</p>
<blockquote>
<figure class="highlight plain"><figcaption><span>&#123;code_block</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt;// 你的 mermaid 代码</span><br><span class="line"> </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>你可以为图像的容器添加属性。 例如：</p>
<p><code></code> <code>puml {align=&quot;center&quot;}
a-&gt;b</code> <code></code><br>将会把 puml 的图像放在中间。</p>
<p>当你保存你的 markdown 文件到 GFM Markdown 时， 所有图像将会被保存为 png 文件到 imageFolderPath 文件夹。 你可以设置导出文件的文件名 {filename=”图片.png”}。<br>例如：<br><figure class="highlight plain"><figcaption><span>&#123;filename</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/21/高阶组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="blacksmith">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/21/高阶组件/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-21T12:06:13+08:00">
                2018-11-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="高阶组件"><a href="#高阶组件" class="headerlink" title="高阶组件"></a>高阶组件</h2><p>在constructor 中的state中声明数据,存放</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">constructor () &#123;</span><br><span class="line">  super()</span><br><span class="line">  this.state = &#123; data: null &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在componentWillMount ()中处理数据，并调用通过setState存储</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">componentWillMount () &#123;</span><br><span class="line">  let data = localStorage.getItem(name)</span><br><span class="line">  this.setState(&#123; data &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在render中通过props传递到被Wrap的组件中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">render () &#123;</span><br><span class="line">  return &lt;WrappedComponent data=&#123;this.state.data&#125; /</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">blacksmith</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">34</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">blacksmith</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
